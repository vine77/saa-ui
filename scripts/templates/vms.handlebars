<div id="vms" class="container-fluid">
  <div class="row-fluid">
    <div class="content">
      <div class="treemap"></div>
      <div class="header">
        <div class="global-actions">
          {{!--
          <a {{action "renderTreemap"}} {{bindAttr class=":btn isTreemapVisible:active"}}><i class="icon-bar-chart"></i> Visualize</a>
          --}}
        </div>
        <div id="filter-form" class="input-prepend pull-right clear-input">
          <span class="add-on"><i class="icon-search"></i></span>
          {{view Ember.TextField id="filter" type="search" valueBinding="filterQuery" placeholder="Filter VMs"}}
          <a class="close clear-button" type="reset" {{action "clearFilter"}}>&times;</a>
        </div>
      </div>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th class="column-small"><a {{action "selectAll"}} title="Select all"><i class="icon-check icon-large"></i></a></th>
            {{#each columns}}
              {{partial columnHeader}}
            {{/each}}
            <th class="column-small">
              <a {{action "refresh"}} class="btn btn-mini"><i {{bindAttr class=":icon-refresh model.isUpdating:icon-spin model.isUpdating:disabled"}}></i></a>
            </th>
          </tr>
        </thead>
          <tbody>
          {{#each filteredModel}}
            <tr {{bindAttr class="isSelected isExpanded"}}>
              <td class="column-small">
                {{view Ember.Checkbox checkedBinding="isSelected"}}
              </td>
              <td class="column-small">
                {{#if status.isUnhealthy}}
                  {{#view App.TooltipView titleBinding="status.healthMessage"}}
                    {{healthIcon status.health}}
                  {{/view}}
                {{else}}
                  {{#view App.TooltipView titleBinding="status.operationalMessage"}}
                    {{operationalIcon status.operational}}
                  {{/view}}
                {{/if}}
              </td>
              <td class="column-small">
                {{#view App.TooltipView titleBinding="status.trustMessage"}}
                  {{#if status.isTrustUnknown}}
                    <i class="icon-large icon-question-sign trust-unknown"></i>
                  {{else}}
                    <i {{bindAttr class=":icon-large status.isTrusted:icon-lock:icon-unlock status.isTrusted:trusted:untrusted"}}></i>
                  {{/if}}
                {{/view}}
              </td>
              <td class="column-small">
                {{#view App.TooltipView titleBinding="status.slaMessage"}}
                  <i {{bindAttr class=":icon-large status.slaViolated:icon-remove:icon-trophy status.slaViolated:error status.slaNotViolated:success status.slaUnknown:inset"}}></i>
                {{/view}}
              </td>
              <td class="column-small">
                {{#view App.TooltipView titleBinding="noisyMessage"}}
                  {{#if isAggressor}}
                    <i {{bindAttr class=":icon-bullhorn :error"}}></i>
                  {{/if}}
                  {{#if isVictim}}
                    <i {{bindAttr class=":icon-headphones :warning"}}></i>
                  {{/if}}
                {{/view}}
              </td>
              <td><a {{action "expand" this}}>{{name}}</a></td>
              <td>
                {{#if node.samControlled}}
                  {{#link-to "nodesNode" node}}{{nodeName}}{{/link-to}}
                {{else}}
                  {{nodeName}}
                {{/if}}
              </td>
              <td>{{na capabilities.cores}}</td>
              <td>{{na utilization.gips_current}}</td>
              <td>{{na utilization.ipc}}</td>
              <td>{{readableSize utilization.memory}}</td>
              <td>
                <div class="contention">
                  {{#if contentionValueExists}}
                    <div class="contention-bar">
                      {{#view App.TooltipView titleBinding="contentionMessage" barBinding="contentionWidth"}}
                        <div class="contention-bar-width" {{bindAttr style="contentionWidth"}} >
                          <div class="contention-gradient"> </div>
                        </div>
                      {{/view}}
                    </div>
                    {{na contention.system.llc.value}}
                  {{else}}
                    <span class="not-applicable">n/a</span>
                  {{/if}}
                </div>
              </td>
              <td>
                {{#if isOn}}
                  <div class="btn-group">
                    <button class="btn disabled btn-mini"><i class="icon-off"></i> Power Off</button>
                    <button data-toggle="dropdown" class="btn dropdown-toggle btn-mini"><span class="caret"></span></button>
                    <ul class="dropdown-menu">
                      <li><a class="disabled"><i class="icon-refresh"></i> Restart</a></li>
                      {{#if App.mtWilson.isInstalled}}
                        <li><a {{action "exportTrustReport" this}}><i class="icon-external-link"></i> Export Trust Report</a></li>
                      {{/if}}
                    </ul>
                  </div>
                {{else}}
                  <div class="btn-group">
                    <button class="btn disabled btn-mini"><i class="icon-bolt"></i> Power On</button>
                    {{#if App.mtWilson.isInstalled}}
                      <button data-toggle="dropdown" class="btn dropdown-toggle  btn-mini"><span class="caret"></span></button>
                      <ul class="dropdown-menu">
                        <li><a {{action "exportTrustReport" this}}><i class="icon-external-link"></i> Export Trust Report</a></li>
                      </ul>
                    {{/if}}
                  </div>
                {{/if}}
              </td>
              <td class="column-small"><a class="btn btn-mini toggle-details" {{action "expand" this}}><i {{bindAttr class="isExpanded:icon-minus:icon-plus"}}></i></a></td>
            </tr>
          {{else}}
            <tr>
              <td colspan="100%">
                {{#unless model.isUpdating}}
                  <div class="alert alert-info">No VMs found.</div>
                {{/unless}}
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
      {{outlet}}
    </div>
  </div>
</div>
